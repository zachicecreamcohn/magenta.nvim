I want to add the ability for my plugin to support claude skills.

When we create a thread, it should look in directories configured by the plugin settings (default should be ".claude/skills". Support similar pattern as the auto context one).

In that directory will be a subdirectory per skill, with a skill.md file in each subdirectory.

That skill.md (not case sensitive) file will have some yaml front matter like this:

```
---
name: your-skill-name
description: Brief description of what this Skill does and when to use it
---

... more skill text ...
```

I want to create a new SkillsManager, modeled after context-manager that is created when a thread is created.

This should read all the skills.md files when it is constructed, and create a map:

```
type SkillsMap = {
  [skillName: string]: {
    skillFile: RelFilePath, // path from cwd to skill file
    name: string, // name from the yaml frontmatter in skill.md
    description: string // description from the yaml frontmatter in skill.md
  }
}
```

When the first message in a conversation is sent, I want to attach a message generated by the skills manager. This should have some instructions like:

```
Here are skills you have available to you:

... listing of skill names, skill files, and skill descriptions ...

When a skill is relevant to a task you are trying to do, first use the get_file tool to read the entire skill markdown file.
```

## Implementation Plan

### 1. Add skills configuration to options

- [x] Update `lua/magenta/options.lua` to add `skillsPaths` option
  - Default value: `{ ".claude/skills" }`
  - Should support glob patterns like `autoContext`
- [x] Update `node/options.ts` type definitions to include `skillsPaths: string[]`

### 2. Create skills manager module

- [x] Create new file `node/skills/skills-manager.ts`
  - [x] Define `SkillInfo` type with `skillFile`, `name`, `description` fields
  - [x] Define `SkillsMap` type as `{ [skillName: string]: SkillInfo }`
  - [x] Create `SkillsManager` class with:
    - [x] Constructor that takes `nvim`, `cwd`, and `options`
    - [x] `skills: SkillsMap` property
    - [x] Static `create()` async factory method that loads all skills
    - [x] `getSkillsPrompt(): string` method to generate the skills listing message
    - [x] `isEmpty(): boolean` helper method

### 3. Implement skills discovery and parsing

- [x] In `SkillsManager.create()`:
  - [x] Use glob patterns from `options.skillsPaths` to find directories
  - [x] For each directory, look for `skill.md` file (case-insensitive)
  - [x] Parse YAML frontmatter from each skill file
  - [x] Validate required fields (`name`, `description`)
  - [x] Build `SkillsMap` with validated skill info
  - [x] Handle errors gracefully (log warnings, skip invalid skills)

### 4. Add YAML parsing dependency

- [x] Install `yaml` package: `npm install yaml`
- [x] Install types: `npm install --save-dev @types/js-yaml` (if using js-yaml) or use the `yaml` package which has built-in types
- [x] Create utility function to extract and parse YAML frontmatter from markdown

### 5. Integrate SkillsManager with Thread

- [x] Update `Thread` class in `node/chat/thread.ts`:
  - [x] Add `skillsManager: SkillsManager` to context in constructor
  - [x] Store reference as instance property
- [x] Update `Chat.createThreadWithContext()` in `node/chat/chat.ts`:
  - [x] Create `SkillsManager` instance alongside `ContextManager`
  - [x] Pass `skillsManager` to `Thread` constructor

### 6. Inject skills prompt on first message

- [x] In `Thread` class, track whether this is the first user message
  - [x] Add `isFirstUserMessage: boolean` flag to thread state
  - [x] Set to `true` on thread creation
- [x] In `Thread.sendMessage()` or similar method:
  - [x] Check if `isFirstUserMessage` is `true`
  - [x] If yes and skills exist, prepend skills prompt to message content
  - [x] Use `skillsManager.getSkillsPrompt()` to generate the prompt
  - [x] Set `isFirstUserMessage = false` after first message

### 7. Format skills prompt message

- [x] In `SkillsManager.getSkillsPrompt()`:
  - [x] Generate formatted list of available skills
  - [x] Include skill name, file path, and description for each
  - [x] Add instruction to use `get_file` tool to read full skill content
  - [x] Return as formatted markdown string

### 8. Error handling and edge cases

- [x] Handle missing or invalid YAML frontmatter gracefully
- [x] Handle duplicate skill names (warn and use first occurrence)
- [x] Handle skills directory not existing (silently skip)
- [x] Handle malformed skill.md files (log error, skip file)
- [x] Ensure case-insensitive matching for skill.md filename

### 9. Testing

- [x] Create test fixtures with sample skill directories
- [x] Test skill discovery with various glob patterns
- [x] Test YAML frontmatter parsing (valid and invalid cases)
- [x] Test skills prompt generation
- [x] Test integration with Thread creation
- [x] Test first message injection of skills prompt
- [x] Test error handling for edge cases

### 10. Documentation

- [x] Update README with skills feature documentation
- [x] Add example skill.md files
- [x] Document configuration options for `skillsPaths`
- [x] Add troubleshooting section for common issues
- [x] Create doc-testing skill from testing documentation in context.md
